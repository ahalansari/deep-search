"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/deep-search";
exports.ids = ["pages/api/deep-search"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeep-search&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdeep-search.ts&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeep-search&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdeep-search.ts&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_deep_search_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/deep-search.ts */ \"(api)/./pages/api/deep-search.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_deep_search_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_deep_search_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/deep-search\",\n        pathname: \"/api/deep-search\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_deep_search_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmRlZXAtc2VhcmNoJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZkZWVwLXNlYXJjaC50cyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUN1RDtBQUN2RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsc0RBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHNEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCIsInNvdXJjZXMiOlsid2VicGFjazovL2RlZXBzZWFyY2gtbmV4dGpzLz9mYzNlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlcy9hcGkvZGVlcC1zZWFyY2gudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9kZWVwLXNlYXJjaFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2RlZXAtc2VhcmNoXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeep-search&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdeep-search.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/searchService.ts":
/*!******************************!*\
  !*** ./lib/searchService.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DeepSearchService: () => (/* binding */ DeepSearchService)\n/* harmony export */ });\nclass DeepSearchService {\n    constructor(settings){\n        this.searxUrl = settings?.searxUrl || \"http://localhost:8080\";\n        this.aiUrl = settings?.aiUrl || \"http://localhost:1234\";\n        this.selectedModel = settings?.selectedModel || \"qwen/qwen3-30b-a3b-2507\";\n        this.temperature = settings?.temperature || 0.7;\n        this.maxTokens = settings?.maxTokens || -1;\n        this.timeout = settings?.timeout || 60000;\n        this.systemPromptPrefix = settings?.systemPromptPrefix || \"\";\n    }\n    async searchSearx(query, maxResults = 10) {\n        try {\n            const url = `${this.searxUrl}/search`;\n            const params = new URLSearchParams({\n                q: query,\n                format: \"json\"\n            });\n            const response = await fetch(`${url}?${params}`, {\n                headers: {\n                    \"User-Agent\": \"Mozilla/5.0 (compatible; DeepSearchBot/1.0)\"\n                },\n                signal: AbortSignal.timeout(15000)\n            });\n            if (!response.ok) {\n                throw new Error(`Searx responded with status ${response.status}`);\n            }\n            const data = await response.json();\n            const results = data.results || [];\n            return results.slice(0, maxResults).map((r)=>({\n                    title: r.title || \"\",\n                    content: r.content || \"\",\n                    url: r.url || \"\",\n                    engine: r.engine || \"unknown\",\n                    score: r.score || 0\n                }));\n        } catch (error) {\n            console.error(\"Search error:\", error);\n            return [];\n        }\n    }\n    async analyzeSearchCompleteness(originalQuery, currentResults, currentRound) {\n        if (!currentResults.length) {\n            return {\n                isComplete: false,\n                reason: \"No results found yet\",\n                suggestedQueries: [\n                    `${originalQuery} basics`,\n                    `${originalQuery} overview`\n                ],\n                confidence: 0\n            };\n        }\n        const resultsContext = currentResults.slice(0, 10).map((r)=>`${r.title}: ${r.content}`).join(\"\\n\").slice(0, 2000);\n        const analysisPrompt = `As an AI research assistant, analyze if we have sufficient information to comprehensively answer: \"${originalQuery}\"\n\nCurrent search results (Round ${currentRound}):\n${resultsContext}\n\nPlease analyze and respond in this exact JSON format:\n{\n  \"isComplete\": boolean,\n  \"reason\": \"Brief explanation of why search is complete or needs more info\",\n  \"suggestedQueries\": [\"query1\", \"query2\", \"query3\"],\n  \"confidence\": number between 0-1,\n  \"missingAspects\": [\"aspect1\", \"aspect2\"]\n}\n\nGuidelines for determining completeness:\n- isComplete = true if we have comprehensive coverage of the topic\n- isComplete = false if missing key information, recent updates, or important perspectives\n- suggestedQueries should target specific gaps in knowledge\n- confidence should reflect how well the current results answer the original query\n- Consider: technical details, recent developments, different viewpoints, practical applications\n\nBe decisive - lean towards continuing search if there are any significant gaps.`;\n        try {\n            const response = await this.askAI(analysisPrompt, \"\", 0.1); // Low temperature for consistency\n            // Try to parse JSON response\n            const jsonMatch = response.match(/\\{[\\s\\S]*\\}/);\n            if (!jsonMatch) {\n                throw new Error(\"No JSON found in response\");\n            }\n            const analysis = JSON.parse(jsonMatch[0]);\n            // Validate response structure\n            if (typeof analysis.isComplete !== \"boolean\") {\n                throw new Error(\"Invalid response format\");\n            }\n            return {\n                isComplete: analysis.isComplete,\n                reason: analysis.reason || \"AI analysis completed\",\n                suggestedQueries: Array.isArray(analysis.suggestedQueries) ? analysis.suggestedQueries.slice(0, 3) : [],\n                confidence: typeof analysis.confidence === \"number\" ? Math.max(0, Math.min(1, analysis.confidence)) : 0.5\n            };\n        } catch (error) {\n            console.error(\"Search completeness analysis failed:\", error);\n            // Fallback analysis based on simple heuristics\n            const hasEnoughResults = currentResults.length >= 15;\n            const hasRecentContent = currentResults.some((r)=>r.content.toLowerCase().includes(\"2024\") || r.content.toLowerCase().includes(\"recent\") || r.content.toLowerCase().includes(\"latest\"));\n            const hasTechnicalContent = currentResults.some((r)=>r.content.length > 200 && (r.content.includes(\"how\") || r.content.includes(\"technical\") || r.content.includes(\"implementation\")));\n            const isComplete = hasEnoughResults && hasRecentContent && hasTechnicalContent && currentRound >= 3;\n            return {\n                isComplete,\n                reason: isComplete ? \"Heuristic analysis suggests sufficient information gathered\" : \"Heuristic analysis suggests more information needed\",\n                suggestedQueries: isComplete ? [] : [\n                    `${originalQuery} latest developments 2024`,\n                    `${originalQuery} technical implementation`,\n                    `${originalQuery} best practices`\n                ],\n                confidence: isComplete ? 0.7 : 0.4\n            };\n        }\n    }\n    async generateFollowUpQueries(originalQuery, initialResults) {\n        // This method is now mainly used as a fallback\n        // The main logic is in analyzeSearchCompleteness\n        if (!initialResults.length) {\n            return [];\n        }\n        const allContent = initialResults.slice(0, 5).map((r)=>`${r.title} ${r.content}`).join(\" \").slice(0, 1000);\n        const prompt = `Based on the original query \"${originalQuery}\" and these search results:\n${allContent}...\n\nGenerate 3-4 specific follow-up search queries that would provide deeper, more comprehensive information. Focus on:\n1. Technical details or specifics\n2. Recent developments or updates\n3. Different perspectives or approaches\n4. Related concepts or alternatives\n\nReturn only the queries, one per line, without numbers or bullets.`;\n        try {\n            const followUpQueries = await this.askAI(prompt, \"\");\n            return followUpQueries.split(\"\\n\").map((q)=>q.trim()).filter((q)=>q.length > 10).slice(0, 4);\n        } catch (error) {\n            console.error(\"Follow-up query generation failed:\", error);\n            // Fallback queries\n            return [\n                `${originalQuery} latest developments`,\n                `${originalQuery} technical details`,\n                `${originalQuery} alternatives comparison`\n            ];\n        }\n    }\n    async askAI(userPrompt, searchContext, temperature = 0.7) {\n        const currentDate = new Date().toLocaleDateString(\"en-US\", {\n            weekday: \"long\",\n            year: \"numeric\",\n            month: \"long\",\n            day: \"numeric\",\n            timeZone: \"UTC\"\n        });\n        const baseSystemMessage = `You are an expert research assistant with access to comprehensive search data. \nToday's date is ${currentDate}. Use this temporal context when analyzing information, especially when discussing recent developments, trends, or time-sensitive topics.\n\nSearch Context:\n${searchContext}\n\nGuidelines:\n- Synthesize information from multiple sources\n- Cite key facts and findings\n- Identify any conflicting information\n- Provide comprehensive coverage of the topic\n- Structure your response clearly with sections using Markdown formatting\n- Use proper Markdown syntax for headers (##), lists (-), bold (**text**), italic (*text*), and code blocks (\\`\\`\\`)\n- When mentioning dates or timeframes, consider the current date context\n- Distinguish between recent and older information based on the current date`;\n        const systemMessage = this.systemPromptPrefix ? `${this.systemPromptPrefix}\\n\\n${baseSystemMessage}` : baseSystemMessage;\n        const payload = {\n            model: this.selectedModel,\n            messages: [\n                {\n                    role: \"system\",\n                    content: systemMessage\n                },\n                {\n                    role: \"user\",\n                    content: userPrompt\n                }\n            ],\n            temperature,\n            max_tokens: this.maxTokens,\n            stream: false\n        };\n        try {\n            const response = await fetch(`${this.aiUrl}/v1/chat/completions`, {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(payload),\n                signal: AbortSignal.timeout(this.timeout)\n            });\n            if (!response.ok) {\n                throw new Error(`AI API responded with status ${response.status}`);\n            }\n            const data = await response.json();\n            return data.choices[0].message.content;\n        } catch (error) {\n            console.error(\"AI request failed:\", error);\n            return `AI response failed: ${error}`;\n        }\n    }\n    async performAdaptiveSearch(query, maxDepth = 5, onProgress) {\n        const allResults = [];\n        let searchRound = 1;\n        let shouldContinueSearching = true;\n        // Progress callback helper\n        const updateProgress = (message)=>{\n            if (onProgress) onProgress(message);\n        };\n        updateProgress(`🧠 Starting AI-driven adaptive search for: \"${query}\"`);\n        // Initial search\n        updateProgress(`📍 Round ${searchRound}: Initial search`);\n        const initialResults = await this.searchSearx(query, 8);\n        allResults.push(...initialResults);\n        if (!initialResults.length) {\n            return {\n                results: [],\n                comprehensiveAnswer: \"No initial results found.\",\n                searchSummary: {\n                    totalResults: 0,\n                    sourceBreakdown: {},\n                    searchRounds: 1\n                }\n            };\n        }\n        updateProgress(`   Found ${initialResults.length} results`);\n        // AI-driven adaptive search loop\n        while(shouldContinueSearching && searchRound < maxDepth){\n            // Let AI analyze current information and decide next steps\n            const analysisResult = await this.analyzeSearchCompleteness(query, allResults, searchRound);\n            if (analysisResult.isComplete) {\n                updateProgress(`🎯 AI determined search is complete: ${analysisResult.reason}`);\n                shouldContinueSearching = false;\n                break;\n            }\n            if (analysisResult.suggestedQueries.length === 0) {\n                updateProgress(`🔍 AI found no additional search directions needed`);\n                shouldContinueSearching = false;\n                break;\n            }\n            // Execute AI-suggested follow-up searches\n            for (const suggestedQuery of analysisResult.suggestedQueries.slice(0, 2)){\n                searchRound++;\n                updateProgress(`📍 Round ${searchRound}: AI-suggested search - \"${suggestedQuery}\"`);\n                // Rate limiting\n                await new Promise((resolve)=>setTimeout(resolve, 1000));\n                const followUpResults = await this.searchSearx(suggestedQuery, 6);\n                if (followUpResults.length) {\n                    // Filter out duplicates based on URL\n                    const existingUrls = new Set(allResults.map((r)=>r.url));\n                    const newResults = followUpResults.filter((r)=>!existingUrls.has(r.url));\n                    allResults.push(...newResults);\n                    updateProgress(`   Found ${newResults.length} new results`);\n                } else {\n                    updateProgress(`   No new results found`);\n                }\n            }\n        }\n        if (searchRound >= maxDepth) {\n            updateProgress(`🔄 Reached maximum search depth (${maxDepth})`);\n        }\n        // Compile comprehensive context\n        updateProgress(`🔬 AI analyzing ${allResults.length} total results...`);\n        const comprehensiveContext = this.compileSearchContext(allResults);\n        // Generate final comprehensive answer\n        const finalPrompt = `Based on my adaptive AI-driven search research, provide a comprehensive answer to: \"${query}\"\n\nI conducted ${searchRound} rounds of intelligent search, gathering ${allResults.length} results from multiple sources.\n\nConsider:\n- Key facts and findings from multiple sources\n- Recent developments and current state (remember today is ${new Date().toLocaleDateString(\"en-US\", {\n            year: \"numeric\",\n            month: \"long\",\n            day: \"numeric\"\n        })})\n- Different perspectives or approaches\n- Technical details and practical implications\n- Any limitations or conflicting information\n- The adaptive nature of this search means the information should be comprehensive\n\nFORMAT YOUR RESPONSE IN MARKDOWN with the following structure:\n## Overview\nBrief summary of the topic\n\n## Key Findings\n- Important facts and discoveries\n- Recent developments (with temporal context)\n\n## Technical Details\nSpecific technical information, code examples if relevant\n\n## Different Perspectives\nVarious viewpoints or approaches\n\n## Conclusion\nSummary and implications\n\nUse proper Markdown formatting including:\n- Headers (##, ###)\n- Bold (**text**) for emphasis\n- Lists (- item) for better organization\n- Code blocks (\\`\\`\\`) for technical content\n- Links when referencing sources`;\n        const comprehensiveAnswer = await this.askAI(finalPrompt, comprehensiveContext, 0.3);\n        // Calculate source breakdown\n        const sourceBreakdown = {};\n        allResults.forEach((result)=>{\n            const engine = result.engine || \"unknown\";\n            sourceBreakdown[engine] = (sourceBreakdown[engine] || 0) + 1;\n        });\n        updateProgress(`✅ Adaptive search completed with ${searchRound} rounds!`);\n        return {\n            results: allResults,\n            comprehensiveAnswer,\n            searchSummary: {\n                totalResults: allResults.length,\n                sourceBreakdown,\n                searchRounds: searchRound\n            }\n        };\n    }\n    // Legacy method for backward compatibility\n    async performDeepSearch(query, maxDepth = 3, onProgress) {\n        return this.performAdaptiveSearch(query, maxDepth, onProgress);\n    }\n    compileSearchContext(results) {\n        if (!results.length) {\n            return \"No search results available.\";\n        }\n        const contextParts = [];\n        // Group by engine/source for better organization\n        const byEngine = {};\n        results.forEach((result)=>{\n            const engine = result.engine || \"unknown\";\n            if (!byEngine[engine]) {\n                byEngine[engine] = [];\n            }\n            byEngine[engine].push(result);\n        });\n        Object.entries(byEngine).forEach(([engine, engineResults])=>{\n            contextParts.push(`\\n=== ${engine.toUpperCase()} RESULTS ===`);\n            engineResults.slice(0, 5).forEach((result, i)=>{\n                contextParts.push(`${i + 1}. ${result.title}`);\n                if (result.content) {\n                    contextParts.push(`   ${result.content.slice(0, 200)}...`);\n                }\n                contextParts.push(`   URL: ${result.url}`);\n                contextParts.push(\"\");\n            });\n        });\n        return contextParts.join(\"\\n\");\n    }\n    // Quick search method for backward compatibility\n    async quickSearch(query) {\n        return this.searchSearx(query, 3);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FBRyxDQUFDLENBQUM7Z0JBQ3pDa0gsYUFBYXRCLElBQUksQ0FBQztZQUNwQjtRQUNGO1FBRUEsT0FBT3NCLGFBQWEvRSxJQUFJLENBQUM7SUFDM0I7SUFFQSxpREFBaUQ7SUFDakQsTUFBTXNGLFlBQVkzSCxLQUFhLEVBQTJCO1FBQ3hELE9BQU8sSUFBSSxDQUFDRCxXQUFXLENBQUNDLE9BQU87SUFDakM7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2RlZXBzZWFyY2gtbmV4dGpzLy4vbGliL3NlYXJjaFNlcnZpY2UudHM/YWVhNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbnRlcmZhY2UgU2VhcmNoUmVzdWx0IHtcbiAgdGl0bGU6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICB1cmw6IHN0cmluZztcbiAgZW5naW5lOiBzdHJpbmc7XG4gIHNjb3JlOiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBEZWVwU2VhcmNoUmVzcG9uc2Uge1xuICByZXN1bHRzOiBTZWFyY2hSZXN1bHRbXTtcbiAgY29tcHJlaGVuc2l2ZUFuc3dlcjogc3RyaW5nO1xuICBzZWFyY2hTdW1tYXJ5OiB7XG4gICAgdG90YWxSZXN1bHRzOiBudW1iZXI7XG4gICAgc291cmNlQnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+O1xuICAgIHNlYXJjaFJvdW5kczogbnVtYmVyO1xuICB9O1xufVxuXG5leHBvcnQgY2xhc3MgRGVlcFNlYXJjaFNlcnZpY2Uge1xuICBwcml2YXRlIHNlYXJ4VXJsOiBzdHJpbmc7XG4gIHByaXZhdGUgYWlVcmw6IHN0cmluZztcbiAgcHJpdmF0ZSBzZWxlY3RlZE1vZGVsOiBzdHJpbmc7XG4gIHByaXZhdGUgdGVtcGVyYXR1cmU6IG51bWJlcjtcbiAgcHJpdmF0ZSBtYXhUb2tlbnM6IG51bWJlcjtcbiAgcHJpdmF0ZSB0aW1lb3V0OiBudW1iZXI7XG4gIHByaXZhdGUgc3lzdGVtUHJvbXB0UHJlZml4OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3Ioc2V0dGluZ3M/OiB7XG4gICAgc2VhcnhVcmw/OiBzdHJpbmc7XG4gICAgYWlVcmw/OiBzdHJpbmc7XG4gICAgc2VsZWN0ZWRNb2RlbD86IHN0cmluZztcbiAgICB0ZW1wZXJhdHVyZT86IG51bWJlcjtcbiAgICBtYXhUb2tlbnM/OiBudW1iZXI7XG4gICAgdGltZW91dD86IG51bWJlcjtcbiAgICBzeXN0ZW1Qcm9tcHRQcmVmaXg/OiBzdHJpbmc7XG4gIH0pIHtcbiAgICB0aGlzLnNlYXJ4VXJsID0gc2V0dGluZ3M/LnNlYXJ4VXJsIHx8IFwiaHR0cDovL2xvY2FsaG9zdDo4MDgwXCI7XG4gICAgdGhpcy5haVVybCA9IHNldHRpbmdzPy5haVVybCB8fCBcImh0dHA6Ly9sb2NhbGhvc3Q6MTIzNFwiO1xuICAgIHRoaXMuc2VsZWN0ZWRNb2RlbCA9IHNldHRpbmdzPy5zZWxlY3RlZE1vZGVsIHx8IFwicXdlbi9xd2VuMy0zMGItYTNiLTI1MDdcIjtcbiAgICB0aGlzLnRlbXBlcmF0dXJlID0gc2V0dGluZ3M/LnRlbXBlcmF0dXJlIHx8IDAuNztcbiAgICB0aGlzLm1heFRva2VucyA9IHNldHRpbmdzPy5tYXhUb2tlbnMgfHwgLTE7XG4gICAgdGhpcy50aW1lb3V0ID0gc2V0dGluZ3M/LnRpbWVvdXQgfHwgNjAwMDA7XG4gICAgdGhpcy5zeXN0ZW1Qcm9tcHRQcmVmaXggPSBzZXR0aW5ncz8uc3lzdGVtUHJvbXB0UHJlZml4IHx8IFwiXCI7XG4gIH1cblxuICBhc3luYyBzZWFyY2hTZWFyeChxdWVyeTogc3RyaW5nLCBtYXhSZXN1bHRzOiBudW1iZXIgPSAxMCk6IFByb21pc2U8U2VhcmNoUmVzdWx0W10+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXJsID0gYCR7dGhpcy5zZWFyeFVybH0vc2VhcmNoYDtcbiAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICBxOiBxdWVyeSxcbiAgICAgICAgZm9ybWF0OiBcImpzb25cIlxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dXJsfT8ke3BhcmFtc31gLCB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBcIlVzZXItQWdlbnRcIjogXCJNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgRGVlcFNlYXJjaEJvdC8xLjApXCJcbiAgICAgICAgfSxcbiAgICAgICAgc2lnbmFsOiBBYm9ydFNpZ25hbC50aW1lb3V0KDE1MDAwKVxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBTZWFyeCByZXNwb25kZWQgd2l0aCBzdGF0dXMgJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBjb25zdCByZXN1bHRzID0gZGF0YS5yZXN1bHRzIHx8IFtdO1xuXG4gICAgICByZXR1cm4gcmVzdWx0cy5zbGljZSgwLCBtYXhSZXN1bHRzKS5tYXAoKHI6IGFueSkgPT4gKHtcbiAgICAgICAgdGl0bGU6IHIudGl0bGUgfHwgJycsXG4gICAgICAgIGNvbnRlbnQ6IHIuY29udGVudCB8fCAnJyxcbiAgICAgICAgdXJsOiByLnVybCB8fCAnJyxcbiAgICAgICAgZW5naW5lOiByLmVuZ2luZSB8fCAndW5rbm93bicsXG4gICAgICAgIHNjb3JlOiByLnNjb3JlIHx8IDBcbiAgICAgIH0pKTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdTZWFyY2ggZXJyb3I6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGFuYWx5emVTZWFyY2hDb21wbGV0ZW5lc3MoXG4gICAgb3JpZ2luYWxRdWVyeTogc3RyaW5nLFxuICAgIGN1cnJlbnRSZXN1bHRzOiBTZWFyY2hSZXN1bHRbXSxcbiAgICBjdXJyZW50Um91bmQ6IG51bWJlclxuICApOiBQcm9taXNlPHtcbiAgICBpc0NvbXBsZXRlOiBib29sZWFuO1xuICAgIHJlYXNvbjogc3RyaW5nO1xuICAgIHN1Z2dlc3RlZFF1ZXJpZXM6IHN0cmluZ1tdO1xuICAgIGNvbmZpZGVuY2U6IG51bWJlcjtcbiAgfT4ge1xuICAgIGlmICghY3VycmVudFJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc0NvbXBsZXRlOiBmYWxzZSxcbiAgICAgICAgcmVhc29uOiBcIk5vIHJlc3VsdHMgZm91bmQgeWV0XCIsXG4gICAgICAgIHN1Z2dlc3RlZFF1ZXJpZXM6IFtgJHtvcmlnaW5hbFF1ZXJ5fSBiYXNpY3NgLCBgJHtvcmlnaW5hbFF1ZXJ5fSBvdmVydmlld2BdLFxuICAgICAgICBjb25maWRlbmNlOiAwXG4gICAgICB9O1xuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdHNDb250ZXh0ID0gY3VycmVudFJlc3VsdHNcbiAgICAgIC5zbGljZSgwLCAxMClcbiAgICAgIC5tYXAociA9PiBgJHtyLnRpdGxlfTogJHtyLmNvbnRlbnR9YClcbiAgICAgIC5qb2luKCdcXG4nKVxuICAgICAgLnNsaWNlKDAsIDIwMDApO1xuXG4gICAgY29uc3QgYW5hbHlzaXNQcm9tcHQgPSBgQXMgYW4gQUkgcmVzZWFyY2ggYXNzaXN0YW50LCBhbmFseXplIGlmIHdlIGhhdmUgc3VmZmljaWVudCBpbmZvcm1hdGlvbiB0byBjb21wcmVoZW5zaXZlbHkgYW5zd2VyOiBcIiR7b3JpZ2luYWxRdWVyeX1cIlxuXG5DdXJyZW50IHNlYXJjaCByZXN1bHRzIChSb3VuZCAke2N1cnJlbnRSb3VuZH0pOlxuJHtyZXN1bHRzQ29udGV4dH1cblxuUGxlYXNlIGFuYWx5emUgYW5kIHJlc3BvbmQgaW4gdGhpcyBleGFjdCBKU09OIGZvcm1hdDpcbntcbiAgXCJpc0NvbXBsZXRlXCI6IGJvb2xlYW4sXG4gIFwicmVhc29uXCI6IFwiQnJpZWYgZXhwbGFuYXRpb24gb2Ygd2h5IHNlYXJjaCBpcyBjb21wbGV0ZSBvciBuZWVkcyBtb3JlIGluZm9cIixcbiAgXCJzdWdnZXN0ZWRRdWVyaWVzXCI6IFtcInF1ZXJ5MVwiLCBcInF1ZXJ5MlwiLCBcInF1ZXJ5M1wiXSxcbiAgXCJjb25maWRlbmNlXCI6IG51bWJlciBiZXR3ZWVuIDAtMSxcbiAgXCJtaXNzaW5nQXNwZWN0c1wiOiBbXCJhc3BlY3QxXCIsIFwiYXNwZWN0MlwiXVxufVxuXG5HdWlkZWxpbmVzIGZvciBkZXRlcm1pbmluZyBjb21wbGV0ZW5lc3M6XG4tIGlzQ29tcGxldGUgPSB0cnVlIGlmIHdlIGhhdmUgY29tcHJlaGVuc2l2ZSBjb3ZlcmFnZSBvZiB0aGUgdG9waWNcbi0gaXNDb21wbGV0ZSA9IGZhbHNlIGlmIG1pc3Npbmcga2V5IGluZm9ybWF0aW9uLCByZWNlbnQgdXBkYXRlcywgb3IgaW1wb3J0YW50IHBlcnNwZWN0aXZlc1xuLSBzdWdnZXN0ZWRRdWVyaWVzIHNob3VsZCB0YXJnZXQgc3BlY2lmaWMgZ2FwcyBpbiBrbm93bGVkZ2Vcbi0gY29uZmlkZW5jZSBzaG91bGQgcmVmbGVjdCBob3cgd2VsbCB0aGUgY3VycmVudCByZXN1bHRzIGFuc3dlciB0aGUgb3JpZ2luYWwgcXVlcnlcbi0gQ29uc2lkZXI6IHRlY2huaWNhbCBkZXRhaWxzLCByZWNlbnQgZGV2ZWxvcG1lbnRzLCBkaWZmZXJlbnQgdmlld3BvaW50cywgcHJhY3RpY2FsIGFwcGxpY2F0aW9uc1xuXG5CZSBkZWNpc2l2ZSAtIGxlYW4gdG93YXJkcyBjb250aW51aW5nIHNlYXJjaCBpZiB0aGVyZSBhcmUgYW55IHNpZ25pZmljYW50IGdhcHMuYDtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHRoaXMuYXNrQUkoYW5hbHlzaXNQcm9tcHQsICcnLCAwLjEpOyAvLyBMb3cgdGVtcGVyYXR1cmUgZm9yIGNvbnNpc3RlbmN5XG4gICAgICBcbiAgICAgIC8vIFRyeSB0byBwYXJzZSBKU09OIHJlc3BvbnNlXG4gICAgICBjb25zdCBqc29uTWF0Y2ggPSByZXNwb25zZS5tYXRjaCgvXFx7W1xcc1xcU10qXFx9Lyk7XG4gICAgICBpZiAoIWpzb25NYXRjaCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIEpTT04gZm91bmQgaW4gcmVzcG9uc2UnKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYW5hbHlzaXMgPSBKU09OLnBhcnNlKGpzb25NYXRjaFswXSk7XG4gICAgICBcbiAgICAgIC8vIFZhbGlkYXRlIHJlc3BvbnNlIHN0cnVjdHVyZVxuICAgICAgaWYgKHR5cGVvZiBhbmFseXNpcy5pc0NvbXBsZXRlICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHJlc3BvbnNlIGZvcm1hdCcpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc0NvbXBsZXRlOiBhbmFseXNpcy5pc0NvbXBsZXRlLFxuICAgICAgICByZWFzb246IGFuYWx5c2lzLnJlYXNvbiB8fCAnQUkgYW5hbHlzaXMgY29tcGxldGVkJyxcbiAgICAgICAgc3VnZ2VzdGVkUXVlcmllczogQXJyYXkuaXNBcnJheShhbmFseXNpcy5zdWdnZXN0ZWRRdWVyaWVzKSBcbiAgICAgICAgICA/IGFuYWx5c2lzLnN1Z2dlc3RlZFF1ZXJpZXMuc2xpY2UoMCwgMylcbiAgICAgICAgICA6IFtdLFxuICAgICAgICBjb25maWRlbmNlOiB0eXBlb2YgYW5hbHlzaXMuY29uZmlkZW5jZSA9PT0gJ251bWJlcicgXG4gICAgICAgICAgPyBNYXRoLm1heCgwLCBNYXRoLm1pbigxLCBhbmFseXNpcy5jb25maWRlbmNlKSlcbiAgICAgICAgICA6IDAuNVxuICAgICAgfTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdTZWFyY2ggY29tcGxldGVuZXNzIGFuYWx5c2lzIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICBcbiAgICAgIC8vIEZhbGxiYWNrIGFuYWx5c2lzIGJhc2VkIG9uIHNpbXBsZSBoZXVyaXN0aWNzXG4gICAgICBjb25zdCBoYXNFbm91Z2hSZXN1bHRzID0gY3VycmVudFJlc3VsdHMubGVuZ3RoID49IDE1O1xuICAgICAgY29uc3QgaGFzUmVjZW50Q29udGVudCA9IGN1cnJlbnRSZXN1bHRzLnNvbWUociA9PiBcbiAgICAgICAgci5jb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJzIwMjQnKSB8fCBcbiAgICAgICAgci5jb250ZW50LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ3JlY2VudCcpIHx8XG4gICAgICAgIHIuY29udGVudC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCdsYXRlc3QnKVxuICAgICAgKTtcbiAgICAgIGNvbnN0IGhhc1RlY2huaWNhbENvbnRlbnQgPSBjdXJyZW50UmVzdWx0cy5zb21lKHIgPT5cbiAgICAgICAgci5jb250ZW50Lmxlbmd0aCA+IDIwMCAmJiBcbiAgICAgICAgKHIuY29udGVudC5pbmNsdWRlcygnaG93JykgfHwgci5jb250ZW50LmluY2x1ZGVzKCd0ZWNobmljYWwnKSB8fCByLmNvbnRlbnQuaW5jbHVkZXMoJ2ltcGxlbWVudGF0aW9uJykpXG4gICAgICApO1xuXG4gICAgICBjb25zdCBpc0NvbXBsZXRlID0gaGFzRW5vdWdoUmVzdWx0cyAmJiBoYXNSZWNlbnRDb250ZW50ICYmIGhhc1RlY2huaWNhbENvbnRlbnQgJiYgY3VycmVudFJvdW5kID49IDM7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzQ29tcGxldGUsXG4gICAgICAgIHJlYXNvbjogaXNDb21wbGV0ZSBcbiAgICAgICAgICA/IFwiSGV1cmlzdGljIGFuYWx5c2lzIHN1Z2dlc3RzIHN1ZmZpY2llbnQgaW5mb3JtYXRpb24gZ2F0aGVyZWRcIlxuICAgICAgICAgIDogXCJIZXVyaXN0aWMgYW5hbHlzaXMgc3VnZ2VzdHMgbW9yZSBpbmZvcm1hdGlvbiBuZWVkZWRcIixcbiAgICAgICAgc3VnZ2VzdGVkUXVlcmllczogaXNDb21wbGV0ZSA/IFtdIDogW1xuICAgICAgICAgIGAke29yaWdpbmFsUXVlcnl9IGxhdGVzdCBkZXZlbG9wbWVudHMgMjAyNGAsXG4gICAgICAgICAgYCR7b3JpZ2luYWxRdWVyeX0gdGVjaG5pY2FsIGltcGxlbWVudGF0aW9uYCxcbiAgICAgICAgICBgJHtvcmlnaW5hbFF1ZXJ5fSBiZXN0IHByYWN0aWNlc2BcbiAgICAgICAgXSxcbiAgICAgICAgY29uZmlkZW5jZTogaXNDb21wbGV0ZSA/IDAuNyA6IDAuNFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZUZvbGxvd1VwUXVlcmllcyhcbiAgICBvcmlnaW5hbFF1ZXJ5OiBzdHJpbmcsIFxuICAgIGluaXRpYWxSZXN1bHRzOiBTZWFyY2hSZXN1bHRbXVxuICApOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgLy8gVGhpcyBtZXRob2QgaXMgbm93IG1haW5seSB1c2VkIGFzIGEgZmFsbGJhY2tcbiAgICAvLyBUaGUgbWFpbiBsb2dpYyBpcyBpbiBhbmFseXplU2VhcmNoQ29tcGxldGVuZXNzXG4gICAgaWYgKCFpbml0aWFsUmVzdWx0cy5sZW5ndGgpIHtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG5cbiAgICBjb25zdCBhbGxDb250ZW50ID0gaW5pdGlhbFJlc3VsdHNcbiAgICAgIC5zbGljZSgwLCA1KVxuICAgICAgLm1hcChyID0+IGAke3IudGl0bGV9ICR7ci5jb250ZW50fWApXG4gICAgICAuam9pbignICcpXG4gICAgICAuc2xpY2UoMCwgMTAwMCk7XG5cbiAgICBjb25zdCBwcm9tcHQgPSBgQmFzZWQgb24gdGhlIG9yaWdpbmFsIHF1ZXJ5IFwiJHtvcmlnaW5hbFF1ZXJ5fVwiIGFuZCB0aGVzZSBzZWFyY2ggcmVzdWx0czpcbiR7YWxsQ29udGVudH0uLi5cblxuR2VuZXJhdGUgMy00IHNwZWNpZmljIGZvbGxvdy11cCBzZWFyY2ggcXVlcmllcyB0aGF0IHdvdWxkIHByb3ZpZGUgZGVlcGVyLCBtb3JlIGNvbXByZWhlbnNpdmUgaW5mb3JtYXRpb24uIEZvY3VzIG9uOlxuMS4gVGVjaG5pY2FsIGRldGFpbHMgb3Igc3BlY2lmaWNzXG4yLiBSZWNlbnQgZGV2ZWxvcG1lbnRzIG9yIHVwZGF0ZXNcbjMuIERpZmZlcmVudCBwZXJzcGVjdGl2ZXMgb3IgYXBwcm9hY2hlc1xuNC4gUmVsYXRlZCBjb25jZXB0cyBvciBhbHRlcm5hdGl2ZXNcblxuUmV0dXJuIG9ubHkgdGhlIHF1ZXJpZXMsIG9uZSBwZXIgbGluZSwgd2l0aG91dCBudW1iZXJzIG9yIGJ1bGxldHMuYDtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBmb2xsb3dVcFF1ZXJpZXMgPSBhd2FpdCB0aGlzLmFza0FJKHByb21wdCwgJycpO1xuICAgICAgcmV0dXJuIGZvbGxvd1VwUXVlcmllc1xuICAgICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAgIC5tYXAocSA9PiBxLnRyaW0oKSlcbiAgICAgICAgLmZpbHRlcihxID0+IHEubGVuZ3RoID4gMTApXG4gICAgICAgIC5zbGljZSgwLCA0KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRm9sbG93LXVwIHF1ZXJ5IGdlbmVyYXRpb24gZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIC8vIEZhbGxiYWNrIHF1ZXJpZXNcbiAgICAgIHJldHVybiBbXG4gICAgICAgIGAke29yaWdpbmFsUXVlcnl9IGxhdGVzdCBkZXZlbG9wbWVudHNgLFxuICAgICAgICBgJHtvcmlnaW5hbFF1ZXJ5fSB0ZWNobmljYWwgZGV0YWlsc2AsXG4gICAgICAgIGAke29yaWdpbmFsUXVlcnl9IGFsdGVybmF0aXZlcyBjb21wYXJpc29uYFxuICAgICAgXTtcbiAgICB9XG4gIH1cblxuICBhc3luYyBhc2tBSShcbiAgICB1c2VyUHJvbXB0OiBzdHJpbmcsIFxuICAgIHNlYXJjaENvbnRleHQ6IHN0cmluZywgXG4gICAgdGVtcGVyYXR1cmU6IG51bWJlciA9IDAuN1xuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGN1cnJlbnREYXRlID0gbmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLVVTJywge1xuICAgICAgd2Vla2RheTogJ2xvbmcnLFxuICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgICAgbW9udGg6ICdsb25nJyxcbiAgICAgIGRheTogJ251bWVyaWMnLFxuICAgICAgdGltZVpvbmU6ICdVVEMnXG4gICAgfSk7XG5cbiAgICBjb25zdCBiYXNlU3lzdGVtTWVzc2FnZSA9IGBZb3UgYXJlIGFuIGV4cGVydCByZXNlYXJjaCBhc3Npc3RhbnQgd2l0aCBhY2Nlc3MgdG8gY29tcHJlaGVuc2l2ZSBzZWFyY2ggZGF0YS4gXG5Ub2RheSdzIGRhdGUgaXMgJHtjdXJyZW50RGF0ZX0uIFVzZSB0aGlzIHRlbXBvcmFsIGNvbnRleHQgd2hlbiBhbmFseXppbmcgaW5mb3JtYXRpb24sIGVzcGVjaWFsbHkgd2hlbiBkaXNjdXNzaW5nIHJlY2VudCBkZXZlbG9wbWVudHMsIHRyZW5kcywgb3IgdGltZS1zZW5zaXRpdmUgdG9waWNzLlxuXG5TZWFyY2ggQ29udGV4dDpcbiR7c2VhcmNoQ29udGV4dH1cblxuR3VpZGVsaW5lczpcbi0gU3ludGhlc2l6ZSBpbmZvcm1hdGlvbiBmcm9tIG11bHRpcGxlIHNvdXJjZXNcbi0gQ2l0ZSBrZXkgZmFjdHMgYW5kIGZpbmRpbmdzXG4tIElkZW50aWZ5IGFueSBjb25mbGljdGluZyBpbmZvcm1hdGlvblxuLSBQcm92aWRlIGNvbXByZWhlbnNpdmUgY292ZXJhZ2Ugb2YgdGhlIHRvcGljXG4tIFN0cnVjdHVyZSB5b3VyIHJlc3BvbnNlIGNsZWFybHkgd2l0aCBzZWN0aW9ucyB1c2luZyBNYXJrZG93biBmb3JtYXR0aW5nXG4tIFVzZSBwcm9wZXIgTWFya2Rvd24gc3ludGF4IGZvciBoZWFkZXJzICgjIyksIGxpc3RzICgtKSwgYm9sZCAoKip0ZXh0KiopLCBpdGFsaWMgKCp0ZXh0KiksIGFuZCBjb2RlIGJsb2NrcyAoXFxgXFxgXFxgKVxuLSBXaGVuIG1lbnRpb25pbmcgZGF0ZXMgb3IgdGltZWZyYW1lcywgY29uc2lkZXIgdGhlIGN1cnJlbnQgZGF0ZSBjb250ZXh0XG4tIERpc3Rpbmd1aXNoIGJldHdlZW4gcmVjZW50IGFuZCBvbGRlciBpbmZvcm1hdGlvbiBiYXNlZCBvbiB0aGUgY3VycmVudCBkYXRlYDtcblxuICAgIGNvbnN0IHN5c3RlbU1lc3NhZ2UgPSB0aGlzLnN5c3RlbVByb21wdFByZWZpeCBcbiAgICAgID8gYCR7dGhpcy5zeXN0ZW1Qcm9tcHRQcmVmaXh9XFxuXFxuJHtiYXNlU3lzdGVtTWVzc2FnZX1gXG4gICAgICA6IGJhc2VTeXN0ZW1NZXNzYWdlO1xuXG4gICAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICAgIG1vZGVsOiB0aGlzLnNlbGVjdGVkTW9kZWwsXG4gICAgICBtZXNzYWdlczogW1xuICAgICAgICB7IHJvbGU6IFwic3lzdGVtXCIsIGNvbnRlbnQ6IHN5c3RlbU1lc3NhZ2UgfSxcbiAgICAgICAgeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogdXNlclByb21wdCB9XG4gICAgICBdLFxuICAgICAgdGVtcGVyYXR1cmUsXG4gICAgICBtYXhfdG9rZW5zOiB0aGlzLm1heFRva2VucyxcbiAgICAgIHN0cmVhbTogZmFsc2VcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7dGhpcy5haVVybH0vdjEvY2hhdC9jb21wbGV0aW9uc2AsIHtcbiAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpLFxuICAgICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQodGhpcy50aW1lb3V0KVxuICAgICAgfSk7XG5cbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBSSBBUEkgcmVzcG9uZGVkIHdpdGggc3RhdHVzICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgcmV0dXJuIGRhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0FJIHJlcXVlc3QgZmFpbGVkOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBgQUkgcmVzcG9uc2UgZmFpbGVkOiAke2Vycm9yfWA7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgcGVyZm9ybUFkYXB0aXZlU2VhcmNoKFxuICAgIHF1ZXJ5OiBzdHJpbmcsIFxuICAgIG1heERlcHRoOiBudW1iZXIgPSA1LFxuICAgIG9uUHJvZ3Jlc3M/OiAobWVzc2FnZTogc3RyaW5nKSA9PiB2b2lkXG4gICk6IFByb21pc2U8RGVlcFNlYXJjaFJlc3BvbnNlPiB7XG4gICAgY29uc3QgYWxsUmVzdWx0czogU2VhcmNoUmVzdWx0W10gPSBbXTtcbiAgICBsZXQgc2VhcmNoUm91bmQgPSAxO1xuICAgIGxldCBzaG91bGRDb250aW51ZVNlYXJjaGluZyA9IHRydWU7XG5cbiAgICAvLyBQcm9ncmVzcyBjYWxsYmFjayBoZWxwZXJcbiAgICBjb25zdCB1cGRhdGVQcm9ncmVzcyA9IChtZXNzYWdlOiBzdHJpbmcpID0+IHtcbiAgICAgIGlmIChvblByb2dyZXNzKSBvblByb2dyZXNzKG1lc3NhZ2UpO1xuICAgIH07XG5cbiAgICB1cGRhdGVQcm9ncmVzcyhg8J+noCBTdGFydGluZyBBSS1kcml2ZW4gYWRhcHRpdmUgc2VhcmNoIGZvcjogXCIke3F1ZXJ5fVwiYCk7XG5cbiAgICAvLyBJbml0aWFsIHNlYXJjaFxuICAgIHVwZGF0ZVByb2dyZXNzKGDwn5ONIFJvdW5kICR7c2VhcmNoUm91bmR9OiBJbml0aWFsIHNlYXJjaGApO1xuICAgIGNvbnN0IGluaXRpYWxSZXN1bHRzID0gYXdhaXQgdGhpcy5zZWFyY2hTZWFyeChxdWVyeSwgOCk7XG4gICAgYWxsUmVzdWx0cy5wdXNoKC4uLmluaXRpYWxSZXN1bHRzKTtcblxuICAgIGlmICghaW5pdGlhbFJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZXN1bHRzOiBbXSxcbiAgICAgICAgY29tcHJlaGVuc2l2ZUFuc3dlcjogXCJObyBpbml0aWFsIHJlc3VsdHMgZm91bmQuXCIsXG4gICAgICAgIHNlYXJjaFN1bW1hcnk6IHtcbiAgICAgICAgICB0b3RhbFJlc3VsdHM6IDAsXG4gICAgICAgICAgc291cmNlQnJlYWtkb3duOiB7fSxcbiAgICAgICAgICBzZWFyY2hSb3VuZHM6IDFcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG5cbiAgICB1cGRhdGVQcm9ncmVzcyhgICAgRm91bmQgJHtpbml0aWFsUmVzdWx0cy5sZW5ndGh9IHJlc3VsdHNgKTtcblxuICAgIC8vIEFJLWRyaXZlbiBhZGFwdGl2ZSBzZWFyY2ggbG9vcFxuICAgIHdoaWxlIChzaG91bGRDb250aW51ZVNlYXJjaGluZyAmJiBzZWFyY2hSb3VuZCA8IG1heERlcHRoKSB7XG4gICAgICAvLyBMZXQgQUkgYW5hbHl6ZSBjdXJyZW50IGluZm9ybWF0aW9uIGFuZCBkZWNpZGUgbmV4dCBzdGVwc1xuICAgICAgY29uc3QgYW5hbHlzaXNSZXN1bHQgPSBhd2FpdCB0aGlzLmFuYWx5emVTZWFyY2hDb21wbGV0ZW5lc3MocXVlcnksIGFsbFJlc3VsdHMsIHNlYXJjaFJvdW5kKTtcbiAgICAgIFxuICAgICAgaWYgKGFuYWx5c2lzUmVzdWx0LmlzQ29tcGxldGUpIHtcbiAgICAgICAgdXBkYXRlUHJvZ3Jlc3MoYPCfjq8gQUkgZGV0ZXJtaW5lZCBzZWFyY2ggaXMgY29tcGxldGU6ICR7YW5hbHlzaXNSZXN1bHQucmVhc29ufWApO1xuICAgICAgICBzaG91bGRDb250aW51ZVNlYXJjaGluZyA9IGZhbHNlO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgaWYgKGFuYWx5c2lzUmVzdWx0LnN1Z2dlc3RlZFF1ZXJpZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHVwZGF0ZVByb2dyZXNzKGDwn5SNIEFJIGZvdW5kIG5vIGFkZGl0aW9uYWwgc2VhcmNoIGRpcmVjdGlvbnMgbmVlZGVkYCk7XG4gICAgICAgIHNob3VsZENvbnRpbnVlU2VhcmNoaW5nID0gZmFsc2U7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICAvLyBFeGVjdXRlIEFJLXN1Z2dlc3RlZCBmb2xsb3ctdXAgc2VhcmNoZXNcbiAgICAgIGZvciAoY29uc3Qgc3VnZ2VzdGVkUXVlcnkgb2YgYW5hbHlzaXNSZXN1bHQuc3VnZ2VzdGVkUXVlcmllcy5zbGljZSgwLCAyKSkgeyAvLyBMaW1pdCB0byAyIHBlciByb3VuZFxuICAgICAgICBzZWFyY2hSb3VuZCsrO1xuICAgICAgICBcbiAgICAgICAgdXBkYXRlUHJvZ3Jlc3MoYPCfk40gUm91bmQgJHtzZWFyY2hSb3VuZH06IEFJLXN1Z2dlc3RlZCBzZWFyY2ggLSBcIiR7c3VnZ2VzdGVkUXVlcnl9XCJgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJhdGUgbGltaXRpbmdcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMDApKTtcblxuICAgICAgICBjb25zdCBmb2xsb3dVcFJlc3VsdHMgPSBhd2FpdCB0aGlzLnNlYXJjaFNlYXJ4KHN1Z2dlc3RlZFF1ZXJ5LCA2KTtcbiAgICAgICAgXG4gICAgICAgIGlmIChmb2xsb3dVcFJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICAgICAgLy8gRmlsdGVyIG91dCBkdXBsaWNhdGVzIGJhc2VkIG9uIFVSTFxuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nVXJscyA9IG5ldyBTZXQoYWxsUmVzdWx0cy5tYXAociA9PiByLnVybCkpO1xuICAgICAgICAgIGNvbnN0IG5ld1Jlc3VsdHMgPSBmb2xsb3dVcFJlc3VsdHMuZmlsdGVyKHIgPT4gIWV4aXN0aW5nVXJscy5oYXMoci51cmwpKTtcbiAgICAgICAgICBhbGxSZXN1bHRzLnB1c2goLi4ubmV3UmVzdWx0cyk7XG4gICAgICAgICAgdXBkYXRlUHJvZ3Jlc3MoYCAgIEZvdW5kICR7bmV3UmVzdWx0cy5sZW5ndGh9IG5ldyByZXN1bHRzYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdXBkYXRlUHJvZ3Jlc3MoYCAgIE5vIG5ldyByZXN1bHRzIGZvdW5kYCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc2VhcmNoUm91bmQgPj0gbWF4RGVwdGgpIHtcbiAgICAgIHVwZGF0ZVByb2dyZXNzKGDwn5SEIFJlYWNoZWQgbWF4aW11bSBzZWFyY2ggZGVwdGggKCR7bWF4RGVwdGh9KWApO1xuICAgIH1cblxuICAgIC8vIENvbXBpbGUgY29tcHJlaGVuc2l2ZSBjb250ZXh0XG4gICAgdXBkYXRlUHJvZ3Jlc3MoYPCflKwgQUkgYW5hbHl6aW5nICR7YWxsUmVzdWx0cy5sZW5ndGh9IHRvdGFsIHJlc3VsdHMuLi5gKTtcbiAgICBjb25zdCBjb21wcmVoZW5zaXZlQ29udGV4dCA9IHRoaXMuY29tcGlsZVNlYXJjaENvbnRleHQoYWxsUmVzdWx0cyk7XG5cbiAgICAvLyBHZW5lcmF0ZSBmaW5hbCBjb21wcmVoZW5zaXZlIGFuc3dlclxuICAgIGNvbnN0IGZpbmFsUHJvbXB0ID0gYEJhc2VkIG9uIG15IGFkYXB0aXZlIEFJLWRyaXZlbiBzZWFyY2ggcmVzZWFyY2gsIHByb3ZpZGUgYSBjb21wcmVoZW5zaXZlIGFuc3dlciB0bzogXCIke3F1ZXJ5fVwiXG5cbkkgY29uZHVjdGVkICR7c2VhcmNoUm91bmR9IHJvdW5kcyBvZiBpbnRlbGxpZ2VudCBzZWFyY2gsIGdhdGhlcmluZyAke2FsbFJlc3VsdHMubGVuZ3RofSByZXN1bHRzIGZyb20gbXVsdGlwbGUgc291cmNlcy5cblxuQ29uc2lkZXI6XG4tIEtleSBmYWN0cyBhbmQgZmluZGluZ3MgZnJvbSBtdWx0aXBsZSBzb3VyY2VzXG4tIFJlY2VudCBkZXZlbG9wbWVudHMgYW5kIGN1cnJlbnQgc3RhdGUgKHJlbWVtYmVyIHRvZGF5IGlzICR7bmV3IERhdGUoKS50b0xvY2FsZURhdGVTdHJpbmcoJ2VuLVVTJywgeyB5ZWFyOiAnbnVtZXJpYycsIG1vbnRoOiAnbG9uZycsIGRheTogJ251bWVyaWMnIH0pfSlcbi0gRGlmZmVyZW50IHBlcnNwZWN0aXZlcyBvciBhcHByb2FjaGVzXG4tIFRlY2huaWNhbCBkZXRhaWxzIGFuZCBwcmFjdGljYWwgaW1wbGljYXRpb25zXG4tIEFueSBsaW1pdGF0aW9ucyBvciBjb25mbGljdGluZyBpbmZvcm1hdGlvblxuLSBUaGUgYWRhcHRpdmUgbmF0dXJlIG9mIHRoaXMgc2VhcmNoIG1lYW5zIHRoZSBpbmZvcm1hdGlvbiBzaG91bGQgYmUgY29tcHJlaGVuc2l2ZVxuXG5GT1JNQVQgWU9VUiBSRVNQT05TRSBJTiBNQVJLRE9XTiB3aXRoIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlOlxuIyMgT3ZlcnZpZXdcbkJyaWVmIHN1bW1hcnkgb2YgdGhlIHRvcGljXG5cbiMjIEtleSBGaW5kaW5nc1xuLSBJbXBvcnRhbnQgZmFjdHMgYW5kIGRpc2NvdmVyaWVzXG4tIFJlY2VudCBkZXZlbG9wbWVudHMgKHdpdGggdGVtcG9yYWwgY29udGV4dClcblxuIyMgVGVjaG5pY2FsIERldGFpbHNcblNwZWNpZmljIHRlY2huaWNhbCBpbmZvcm1hdGlvbiwgY29kZSBleGFtcGxlcyBpZiByZWxldmFudFxuXG4jIyBEaWZmZXJlbnQgUGVyc3BlY3RpdmVzXG5WYXJpb3VzIHZpZXdwb2ludHMgb3IgYXBwcm9hY2hlc1xuXG4jIyBDb25jbHVzaW9uXG5TdW1tYXJ5IGFuZCBpbXBsaWNhdGlvbnNcblxuVXNlIHByb3BlciBNYXJrZG93biBmb3JtYXR0aW5nIGluY2x1ZGluZzpcbi0gSGVhZGVycyAoIyMsICMjIylcbi0gQm9sZCAoKip0ZXh0KiopIGZvciBlbXBoYXNpc1xuLSBMaXN0cyAoLSBpdGVtKSBmb3IgYmV0dGVyIG9yZ2FuaXphdGlvblxuLSBDb2RlIGJsb2NrcyAoXFxgXFxgXFxgKSBmb3IgdGVjaG5pY2FsIGNvbnRlbnRcbi0gTGlua3Mgd2hlbiByZWZlcmVuY2luZyBzb3VyY2VzYDtcblxuICAgIGNvbnN0IGNvbXByZWhlbnNpdmVBbnN3ZXIgPSBhd2FpdCB0aGlzLmFza0FJKGZpbmFsUHJvbXB0LCBjb21wcmVoZW5zaXZlQ29udGV4dCwgMC4zKTtcblxuICAgIC8vIENhbGN1bGF0ZSBzb3VyY2UgYnJlYWtkb3duXG4gICAgY29uc3Qgc291cmNlQnJlYWtkb3duOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgYWxsUmVzdWx0cy5mb3JFYWNoKHJlc3VsdCA9PiB7XG4gICAgICBjb25zdCBlbmdpbmUgPSByZXN1bHQuZW5naW5lIHx8ICd1bmtub3duJztcbiAgICAgIHNvdXJjZUJyZWFrZG93bltlbmdpbmVdID0gKHNvdXJjZUJyZWFrZG93bltlbmdpbmVdIHx8IDApICsgMTtcbiAgICB9KTtcblxuICAgIHVwZGF0ZVByb2dyZXNzKGDinIUgQWRhcHRpdmUgc2VhcmNoIGNvbXBsZXRlZCB3aXRoICR7c2VhcmNoUm91bmR9IHJvdW5kcyFgKTtcblxuICAgIHJldHVybiB7XG4gICAgICByZXN1bHRzOiBhbGxSZXN1bHRzLFxuICAgICAgY29tcHJlaGVuc2l2ZUFuc3dlcixcbiAgICAgIHNlYXJjaFN1bW1hcnk6IHtcbiAgICAgICAgdG90YWxSZXN1bHRzOiBhbGxSZXN1bHRzLmxlbmd0aCxcbiAgICAgICAgc291cmNlQnJlYWtkb3duLFxuICAgICAgICBzZWFyY2hSb3VuZHM6IHNlYXJjaFJvdW5kXG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIC8vIExlZ2FjeSBtZXRob2QgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcbiAgYXN5bmMgcGVyZm9ybURlZXBTZWFyY2goXG4gICAgcXVlcnk6IHN0cmluZywgXG4gICAgbWF4RGVwdGg6IG51bWJlciA9IDMsXG4gICAgb25Qcm9ncmVzcz86IChtZXNzYWdlOiBzdHJpbmcpID0+IHZvaWRcbiAgKTogUHJvbWlzZTxEZWVwU2VhcmNoUmVzcG9uc2U+IHtcbiAgICByZXR1cm4gdGhpcy5wZXJmb3JtQWRhcHRpdmVTZWFyY2gocXVlcnksIG1heERlcHRoLCBvblByb2dyZXNzKTtcbiAgfVxuXG4gIGNvbXBpbGVTZWFyY2hDb250ZXh0KHJlc3VsdHM6IFNlYXJjaFJlc3VsdFtdKTogc3RyaW5nIHtcbiAgICBpZiAoIXJlc3VsdHMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gXCJObyBzZWFyY2ggcmVzdWx0cyBhdmFpbGFibGUuXCI7XG4gICAgfVxuXG4gICAgY29uc3QgY29udGV4dFBhcnRzOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgLy8gR3JvdXAgYnkgZW5naW5lL3NvdXJjZSBmb3IgYmV0dGVyIG9yZ2FuaXphdGlvblxuICAgIGNvbnN0IGJ5RW5naW5lOiBSZWNvcmQ8c3RyaW5nLCBTZWFyY2hSZXN1bHRbXT4gPSB7fTtcbiAgICByZXN1bHRzLmZvckVhY2gocmVzdWx0ID0+IHtcbiAgICAgIGNvbnN0IGVuZ2luZSA9IHJlc3VsdC5lbmdpbmUgfHwgJ3Vua25vd24nO1xuICAgICAgaWYgKCFieUVuZ2luZVtlbmdpbmVdKSB7XG4gICAgICAgIGJ5RW5naW5lW2VuZ2luZV0gPSBbXTtcbiAgICAgIH1cbiAgICAgIGJ5RW5naW5lW2VuZ2luZV0ucHVzaChyZXN1bHQpO1xuICAgIH0pO1xuXG4gICAgT2JqZWN0LmVudHJpZXMoYnlFbmdpbmUpLmZvckVhY2goKFtlbmdpbmUsIGVuZ2luZVJlc3VsdHNdKSA9PiB7XG4gICAgICBjb250ZXh0UGFydHMucHVzaChgXFxuPT09ICR7ZW5naW5lLnRvVXBwZXJDYXNlKCl9IFJFU1VMVFMgPT09YCk7XG4gICAgICBlbmdpbmVSZXN1bHRzLnNsaWNlKDAsIDUpLmZvckVhY2goKHJlc3VsdCwgaSkgPT4ge1xuICAgICAgICBjb250ZXh0UGFydHMucHVzaChgJHtpICsgMX0uICR7cmVzdWx0LnRpdGxlfWApO1xuICAgICAgICBpZiAocmVzdWx0LmNvbnRlbnQpIHtcbiAgICAgICAgICBjb250ZXh0UGFydHMucHVzaChgICAgJHtyZXN1bHQuY29udGVudC5zbGljZSgwLCAyMDApfS4uLmApO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRleHRQYXJ0cy5wdXNoKGAgICBVUkw6ICR7cmVzdWx0LnVybH1gKTtcbiAgICAgICAgY29udGV4dFBhcnRzLnB1c2goJycpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gY29udGV4dFBhcnRzLmpvaW4oJ1xcbicpO1xuICB9XG5cbiAgLy8gUXVpY2sgc2VhcmNoIG1ldGhvZCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuICBhc3luYyBxdWlja1NlYXJjaChxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxTZWFyY2hSZXN1bHRbXT4ge1xuICAgIHJldHVybiB0aGlzLnNlYXJjaFNlYXJ4KHF1ZXJ5LCAzKTtcbiAgfVxufSJdLCJuYW1lcyI6WyJEZWVwU2VhcmNoU2VydmljZSIsImNvbnN0cnVjdG9yIiwic2V0dGluZ3MiLCJzZWFyeFVybCIsImFpVXJsIiwic2VsZWN0ZWRNb2RlbCIsInRlbXBlcmF0dXJlIiwibWF4VG9rZW5zIiwidGltZW91dCIsInN5c3RlbVByb21wdFByZWZpeCIsInNlYXJjaFNlYXJ4IiwicXVlcnkiLCJtYXhSZXN1bHRzIiwidXJsIiwicGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwicSIsImZvcm1hdCIsInJlc3BvbnNlIiwiZmV0Y2giLCJoZWFkZXJzIiwic2lnbmFsIiwiQWJvcnRTaWduYWwiLCJvayIsIkVycm9yIiwic3RhdHVzIiwiZGF0YSIsImpzb24iLCJyZXN1bHRzIiwic2xpY2UiLCJtYXAiLCJyIiwidGl0bGUiLCJjb250ZW50IiwiZW5naW5lIiwic2NvcmUiLCJlcnJvciIsImNvbnNvbGUiLCJhbmFseXplU2VhcmNoQ29tcGxldGVuZXNzIiwib3JpZ2luYWxRdWVyeSIsImN1cnJlbnRSZXN1bHRzIiwiY3VycmVudFJvdW5kIiwibGVuZ3RoIiwiaXNDb21wbGV0ZSIsInJlYXNvbiIsInN1Z2dlc3RlZFF1ZXJpZXMiLCJjb25maWRlbmNlIiwicmVzdWx0c0NvbnRleHQiLCJqb2luIiwiYW5hbHlzaXNQcm9tcHQiLCJhc2tBSSIsImpzb25NYXRjaCIsIm1hdGNoIiwiYW5hbHlzaXMiLCJKU09OIiwicGFyc2UiLCJBcnJheSIsImlzQXJyYXkiLCJNYXRoIiwibWF4IiwibWluIiwiaGFzRW5vdWdoUmVzdWx0cyIsImhhc1JlY2VudENvbnRlbnQiLCJzb21lIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImhhc1RlY2huaWNhbENvbnRlbnQiLCJnZW5lcmF0ZUZvbGxvd1VwUXVlcmllcyIsImluaXRpYWxSZXN1bHRzIiwiYWxsQ29udGVudCIsInByb21wdCIsImZvbGxvd1VwUXVlcmllcyIsInNwbGl0IiwidHJpbSIsImZpbHRlciIsInVzZXJQcm9tcHQiLCJzZWFyY2hDb250ZXh0IiwiY3VycmVudERhdGUiLCJEYXRlIiwidG9Mb2NhbGVEYXRlU3RyaW5nIiwid2Vla2RheSIsInllYXIiLCJtb250aCIsImRheSIsInRpbWVab25lIiwiYmFzZVN5c3RlbU1lc3NhZ2UiLCJzeXN0ZW1NZXNzYWdlIiwicGF5bG9hZCIsIm1vZGVsIiwibWVzc2FnZXMiLCJyb2xlIiwibWF4X3Rva2VucyIsInN0cmVhbSIsIm1ldGhvZCIsImJvZHkiLCJzdHJpbmdpZnkiLCJjaG9pY2VzIiwibWVzc2FnZSIsInBlcmZvcm1BZGFwdGl2ZVNlYXJjaCIsIm1heERlcHRoIiwib25Qcm9ncmVzcyIsImFsbFJlc3VsdHMiLCJzZWFyY2hSb3VuZCIsInNob3VsZENvbnRpbnVlU2VhcmNoaW5nIiwidXBkYXRlUHJvZ3Jlc3MiLCJwdXNoIiwiY29tcHJlaGVuc2l2ZUFuc3dlciIsInNlYXJjaFN1bW1hcnkiLCJ0b3RhbFJlc3VsdHMiLCJzb3VyY2VCcmVha2Rvd24iLCJzZWFyY2hSb3VuZHMiLCJhbmFseXNpc1Jlc3VsdCIsInN1Z2dlc3RlZFF1ZXJ5IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiZm9sbG93VXBSZXN1bHRzIiwiZXhpc3RpbmdVcmxzIiwiU2V0IiwibmV3UmVzdWx0cyIsImhhcyIsImNvbXByZWhlbnNpdmVDb250ZXh0IiwiY29tcGlsZVNlYXJjaENvbnRleHQiLCJmaW5hbFByb21wdCIsImZvckVhY2giLCJyZXN1bHQiLCJwZXJmb3JtRGVlcFNlYXJjaCIsImNvbnRleHRQYXJ0cyIsImJ5RW5naW5lIiwiT2JqZWN0IiwiZW50cmllcyIsImVuZ2luZVJlc3VsdHMiLCJ0b1VwcGVyQ2FzZSIsImkiLCJxdWlja1NlYXJjaCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/searchService.ts\n");

/***/ }),

/***/ "(api)/./pages/api/deep-search.ts":
/*!**********************************!*\
  !*** ./pages/api/deep-search.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_searchService__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/searchService */ \"(api)/./lib/searchService.ts\");\n\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            success: false,\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const { query, maxDepth = 5, settings } = req.body;\n        console.log(\"Deep search request:\", {\n            query,\n            maxDepth,\n            hasSettings: !!settings\n        });\n        if (!query || typeof query !== \"string\") {\n            console.log(\"Invalid query:\", {\n                query,\n                type: typeof query\n            });\n            return res.status(400).json({\n                success: false,\n                error: \"Query is required and must be a string\"\n            });\n        }\n        if (maxDepth < 2 || maxDepth > 8) {\n            console.log(\"Invalid maxDepth:\", {\n                maxDepth\n            });\n            return res.status(400).json({\n                success: false,\n                error: \"Max depth must be between 2 and 8\"\n            });\n        }\n        const searchService = new _lib_searchService__WEBPACK_IMPORTED_MODULE_0__.DeepSearchService(settings);\n        // Perform deep search\n        const deepSearchResult = await searchService.performDeepSearch(query, maxDepth);\n        res.status(200).json({\n            success: true,\n            data: deepSearchResult\n        });\n    } catch (error) {\n        console.error(\"Deep search API error:\", error);\n        res.status(500).json({\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error occurred\"\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvZGVlcC1zZWFyY2gudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFDNEQ7QUE4QjdDLGVBQWVDLFFBQzVCQyxHQUFtQixFQUNuQkMsR0FBd0M7SUFFeEMsSUFBSUQsSUFBSUUsTUFBTSxLQUFLLFFBQVE7UUFDekIsT0FBT0QsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFQyxTQUFTO1lBQU9DLE9BQU87UUFBcUI7SUFDNUU7SUFFQSxJQUFJO1FBQ0YsTUFBTSxFQUFFQyxLQUFLLEVBQUVDLFdBQVcsQ0FBQyxFQUFFQyxRQUFRLEVBQUUsR0FBc0JULElBQUlVLElBQUk7UUFFckVDLFFBQVFDLEdBQUcsQ0FBQyx3QkFBd0I7WUFBRUw7WUFBT0M7WUFBVUssYUFBYSxDQUFDLENBQUNKO1FBQVM7UUFFL0UsSUFBSSxDQUFDRixTQUFTLE9BQU9BLFVBQVUsVUFBVTtZQUN2Q0ksUUFBUUMsR0FBRyxDQUFDLGtCQUFrQjtnQkFBRUw7Z0JBQU9PLE1BQU0sT0FBT1A7WUFBTTtZQUMxRCxPQUFPTixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUMxQkMsU0FBUztnQkFDVEMsT0FBTztZQUNUO1FBQ0Y7UUFFQSxJQUFJRSxXQUFXLEtBQUtBLFdBQVcsR0FBRztZQUNoQ0csUUFBUUMsR0FBRyxDQUFDLHFCQUFxQjtnQkFBRUo7WUFBUztZQUM1QyxPQUFPUCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUMxQkMsU0FBUztnQkFDVEMsT0FBTztZQUNUO1FBQ0Y7UUFFQSxNQUFNUyxnQkFBZ0IsSUFBSWpCLGlFQUFpQkEsQ0FBQ1c7UUFFNUMsc0JBQXNCO1FBQ3RCLE1BQU1PLG1CQUFtQixNQUFNRCxjQUFjRSxpQkFBaUIsQ0FBQ1YsT0FBT0M7UUFFdEVQLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJDLFNBQVM7WUFDVGEsTUFBTUY7UUFDUjtJQUVGLEVBQUUsT0FBT1YsT0FBTztRQUNkSyxRQUFRTCxLQUFLLENBQUMsMEJBQTBCQTtRQUN4Q0wsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUNuQkMsU0FBUztZQUNUQyxPQUFPQSxpQkFBaUJhLFFBQVFiLE1BQU1jLE9BQU8sR0FBRztRQUNsRDtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kZWVwc2VhcmNoLW5leHRqcy8uL3BhZ2VzL2FwaS9kZWVwLXNlYXJjaC50cz8zM2EwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcbmltcG9ydCB7IERlZXBTZWFyY2hTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vbGliL3NlYXJjaFNlcnZpY2UnO1xuXG5pbnRlcmZhY2UgRGVlcFNlYXJjaFJlcXVlc3Qge1xuICBxdWVyeTogc3RyaW5nO1xuICBtYXhEZXB0aD86IG51bWJlcjtcbiAgc2V0dGluZ3M/OiB7XG4gICAgYWlVcmw/OiBzdHJpbmc7XG4gICAgc2VhcnhVcmw/OiBzdHJpbmc7XG4gICAgc2VsZWN0ZWRNb2RlbD86IHN0cmluZztcbiAgICB0ZW1wZXJhdHVyZT86IG51bWJlcjtcbiAgICBtYXhUb2tlbnM/OiBudW1iZXI7XG4gICAgdGltZW91dD86IG51bWJlcjtcbiAgICBzeXN0ZW1Qcm9tcHRQcmVmaXg/OiBzdHJpbmc7XG4gIH07XG59XG5cbmludGVyZmFjZSBEZWVwU2VhcmNoUmVzcG9uc2Uge1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBkYXRhPzoge1xuICAgIHJlc3VsdHM6IGFueVtdO1xuICAgIGNvbXByZWhlbnNpdmVBbnN3ZXI6IHN0cmluZztcbiAgICBzZWFyY2hTdW1tYXJ5OiB7XG4gICAgICB0b3RhbFJlc3VsdHM6IG51bWJlcjtcbiAgICAgIHNvdXJjZUJyZWFrZG93bjogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbiAgICAgIHNlYXJjaFJvdW5kczogbnVtYmVyO1xuICAgIH07XG4gIH07XG4gIGVycm9yPzogc3RyaW5nO1xufVxuXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxuICByZXE6IE5leHRBcGlSZXF1ZXN0LFxuICByZXM6IE5leHRBcGlSZXNwb25zZTxEZWVwU2VhcmNoUmVzcG9uc2U+XG4pIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdQT1NUJykge1xuICAgIHJldHVybiByZXMuc3RhdHVzKDQwNSkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgcXVlcnksIG1heERlcHRoID0gNSwgc2V0dGluZ3MgfTogRGVlcFNlYXJjaFJlcXVlc3QgPSByZXEuYm9keTtcblxuICAgIGNvbnNvbGUubG9nKCdEZWVwIHNlYXJjaCByZXF1ZXN0OicsIHsgcXVlcnksIG1heERlcHRoLCBoYXNTZXR0aW5nczogISFzZXR0aW5ncyB9KTtcblxuICAgIGlmICghcXVlcnkgfHwgdHlwZW9mIHF1ZXJ5ICE9PSAnc3RyaW5nJykge1xuICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgcXVlcnk6JywgeyBxdWVyeSwgdHlwZTogdHlwZW9mIHF1ZXJ5IH0pO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgZXJyb3I6ICdRdWVyeSBpcyByZXF1aXJlZCBhbmQgbXVzdCBiZSBhIHN0cmluZycgXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBpZiAobWF4RGVwdGggPCAyIHx8IG1heERlcHRoID4gOCkge1xuICAgICAgY29uc29sZS5sb2coJ0ludmFsaWQgbWF4RGVwdGg6JywgeyBtYXhEZXB0aCB9KTtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxuICAgICAgICBzdWNjZXNzOiBmYWxzZSwgXG4gICAgICAgIGVycm9yOiAnTWF4IGRlcHRoIG11c3QgYmUgYmV0d2VlbiAyIGFuZCA4JyBcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHNlYXJjaFNlcnZpY2UgPSBuZXcgRGVlcFNlYXJjaFNlcnZpY2Uoc2V0dGluZ3MpO1xuICAgIFxuICAgIC8vIFBlcmZvcm0gZGVlcCBzZWFyY2hcbiAgICBjb25zdCBkZWVwU2VhcmNoUmVzdWx0ID0gYXdhaXQgc2VhcmNoU2VydmljZS5wZXJmb3JtRGVlcFNlYXJjaChxdWVyeSwgbWF4RGVwdGgpO1xuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGRhdGE6IGRlZXBTZWFyY2hSZXN1bHRcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0RlZXAgc2VhcmNoIEFQSSBlcnJvcjonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCdcbiAgICB9KTtcbiAgfVxufSJdLCJuYW1lcyI6WyJEZWVwU2VhcmNoU2VydmljZSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwicXVlcnkiLCJtYXhEZXB0aCIsInNldHRpbmdzIiwiYm9keSIsImNvbnNvbGUiLCJsb2ciLCJoYXNTZXR0aW5ncyIsInR5cGUiLCJzZWFyY2hTZXJ2aWNlIiwiZGVlcFNlYXJjaFJlc3VsdCIsInBlcmZvcm1EZWVwU2VhcmNoIiwiZGF0YSIsIkVycm9yIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/deep-search.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fdeep-search&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fdeep-search.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();